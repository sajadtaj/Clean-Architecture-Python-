PROJECT_NAME=crypto_option_arbitrage
SRC_DIR=src/$(PROJECT_NAME)
CURRENT_USER:=$(shell whoami)
CURRENT_GROUP:=$(shell id -gn)

.PHONY: create clean set-permission help

create:
	@echo "ğŸ“ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø³ÛŒØ± Ù¾Ø±ÙˆÚ˜Ù‡ $(PROJECT_NAME)..."
	@if [ ! -d "$(SRC_DIR)" ]; then \
		echo "ğŸš€ Ø³Ø§Ø®Øª Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡ $(PROJECT_NAME)"; \
		mkdir -p $(SRC_DIR)/core/entities; \
		mkdir -p $(SRC_DIR)/core/value_objects; \
		mkdir -p $(SRC_DIR)/use_cases; \
		mkdir -p $(SRC_DIR)/interfaces/api; \
		mkdir -p $(SRC_DIR)/interfaces/cli; \
		mkdir -p $(SRC_DIR)/interfaces/scheduler; \
		mkdir -p $(SRC_DIR)/infrastructure/data_providers; \
		mkdir -p $(SRC_DIR)/infrastructure/db; \
		mkdir -p $(SRC_DIR)/infrastructure/notifiers; \
		mkdir -p $(SRC_DIR)/config; \
		mkdir -p $(SRC_DIR)/tests; \
		touch $(SRC_DIR)/main.py; \
		touch $(SRC_DIR)/config/.env.example; \
		find $(SRC_DIR) -type d -exec touch {}/__init__.py \; ;\
		echo "âœ… Ø³Ø§Ø®Øª Ù¾Ø±ÙˆÚ˜Ù‡ $(PROJECT_NAME) Ú©Ø§Ù…Ù„ Ø´Ø¯."; \
	else \
		echo "âš ï¸ Ù…Ø³ÛŒØ± $(SRC_DIR) Ø§Ø² Ù‚Ø¨Ù„ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯. Ù‡ÛŒÚ† ØªØºÛŒÛŒØ±ÛŒ Ø§Ø¹Ù…Ø§Ù„ Ù†Ø´Ø¯."; \
	fi

clean:
	@echo "âš ï¸ Ø¯Ø± Ø­Ø§Ù„ Ø­Ø°Ù Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡ $(PROJECT_NAME)..."
	@rm -rf $(SRC_DIR)
	@echo "ğŸ—‘ï¸ Ø³Ø§Ø®ØªØ§Ø± Ø­Ø°Ù Ø´Ø¯."

set-permission:
	@echo "ğŸ” Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¹Ø·Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ ($(CURRENT_USER)) Ø±ÙˆÛŒ Ù¾Ø±ÙˆÚ˜Ù‡..."
	@sudo chown -R $(CURRENT_USER):$(CURRENT_GROUP) src/
	@echo "âœ… Ù…Ø§Ù„Ú©ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ù‡ $(CURRENT_USER):$(CURRENT_GROUP) ØªØºÛŒÛŒØ± ÛŒØ§ÙØª."

help:
	@echo "ğŸ“˜ Ø¯Ø³ØªÙˆØ±Ø§Øª Ù…ÙˆØ¬ÙˆØ¯:"
	@echo "  make create          # Ø³Ø§Ø®Øª Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡ Ø¯Ø± Ù…Ø³ÛŒØ± src/"
	@echo "  make clean           # Ø­Ø°Ù Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡"
	@echo "  make set-permission  # ØªØºÛŒÛŒØ± Ù…Ø§Ù„Ú©ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ"
	@echo "  make help            # Ù†Ù…Ø§ÛŒØ´ Ø§ÛŒÙ† Ø±Ø§Ù‡Ù†Ù…Ø§"
