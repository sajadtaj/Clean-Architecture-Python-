<div dir='rtl'>

# ๐งพ ูุณุชูุฏ ูุนูุงุฑ ูุงู Entity

### ูพุฑูฺู: ฺฉุดู ูุฑุตุช ุขุฑุจุชุฑุงฺ ุฏุฑ ุขูพุดู ุฏุงุฑุงโูุง (ุณูุงูุ ุตูุฏููโูุงุ ฺฉุฑูพุชู ู ...)

---

## ๐ฏ ูุฏู ูุงู Entity

ูุงู `entity` ูุณุฆูู ูุฏูโุณุงุฒ **ููุฌูุฏุชโูุง ุฏุงููู ุงุตู ูุงู** (ุฏุงุฑุงโูุงุ ุขูพุดูโูุงุ ุงุณุชุฑุงุชฺโูุง) ุจู ุดฺฉู ุงูุชุฒุงุน ู ูุณุชูู ุงุฒ ุชฺฉููููฺ ุงุณุช. ุงู ูุงู:

* ูุงุจุณุชู ุจู ูฺ ุฏุชุงุจุณุ APIุ ูุงู ุง ุณุฑูุณ ุฎุงุฑุฌ ูุณุช (pure domain logic)
* ูุณุชู ุชุญูู ูพุฑูฺู ุฑุง ุฏุฑ ุฎูุฏ ุฌุง ุฏุงุฏู ุงุณุช
* ูพุงูโฺฏุฐุงุฑ ุงุตูู Domain-Driven Design (DDD) ุงุณุช

---

## ๐๏ธ ุณุงุฎุชุงุฑ ูุงู `entity`

</div>

```
core/
โโโ entities/
    โโโ asset.py                 โ ฺฉูุงุณ ูพุงู AbstractAsset
    โโโ stock_asset.py          โ ุฏุงุฑุง ุณูุงู
    โโโ etf_asset.py            โ ุตูุฏูู ูุงุจู ูุนุงููู
    โโโ leverage_etf_asset.py   โ ุตูุฏูู ุงูุฑู
    โโโ crypto_asset.py         โ ุฏุงุฑุง ฺฉุฑูพุชู
    โโโ option.py               โ ฺฉูุงุณ ูพุงู AbstractOption
    โโโ enums.py                โ ุงููุงุน (Enums) ูุซู OptionType, AssetClass, Market
```
<div dir='rtl'>

---

## ๐งฉ ฺฉูุงุณโูุง ู ูุงุจุณุชฺฏโูุง

### โ `AbstractAsset`

ูุฏู ุงูุชุฒุงุน ููู ุฏุงุฑุงโูุงุ ุดุงูู:

* ูฺฺฏโูุง ุนููู ูุซู `symbol`, `price`, `market`, `ask`, `bid`
* ููุทูโูุง ุฏุงููู ูุซู:

  * `is_valid()`
  * `get_transaction_fee()`
  * `has_price_limit_breach()`
  * `is_trading_now()`

๐ ูุงุจุณุชฺฏ ุจู `AssetClass`, `Market`, `config` ุจุฑุง ููุงูู ุจุงุฒุงุฑ ู ุฏุงุฑุง.

---

### โ ฺฉูุงุณโูุง ูุฑุฒูุฏ:

| ฺฉูุงุณ               | ุงุฑุซโุจุฑ ุงุฒ      | ุชูุถุญุงุช                    |
| ------------------ | --------------- | -------------------------- |
| `StockAsset`       | `AbstractAsset` | ุณูุงู ุจูุฑุณ                 |
| `ETFAsset`         | `AbstractAsset` | ุตูุฏููโูุง ูุงุจู ูุนุงููู      |
| `LeverageETFAsset` | `AbstractAsset` | ุตูุฏููโูุง ุงูุฑู ุจูุฑุณ      |
| `CryptoAsset`      | `AbstractAsset` | ุฑูุฒุงุฑุฒูุง ุจุง ุจุงุฒุงุฑ ฒด ุณุงุนุชู |

๐ ูุฑ ฺฉูุงุณ ุงุทูุงุนุงุช ูุซู `settlement_days`, `trading_hours`, `fee` ุฑุง ุงุฒ ูุงูโูุง ฺฉุงููฺฏ ูุซู `ASSET_TRADING_HOURS` ูโฺฏุฑุฏุ **ูู hardcode**.

---

### โ `AbstractOption`

ูุฏู ุงูุชุฒุงุน ฺฉ ูุฑุงุฑุฏุงุฏ ุงุฎุชุงุฑ ูุนุงููู ุจุง ูุชุฏูุง ุชุญูู:

* `is_in_the_money()`
* `get_payoff()`
* `get_break_even_price()`
* `has_expired()`

๐ ุจู ูฺ API ุง ุฏุชุงุจุณ ูุงุจุณุชู ูุณุช. ููุท ููุทู ูุงู ุฎุงูุต ุฏุงุฑุฏ.

---

## ๐ง ฺุฑุง ฺฉูุงุณโูุง ุฏุงุฑุง ูุณุชูู ุฏุงุฑูุ

ุณุคุงูุงุช ููู:

> ฺุฑุง `StockAsset`, `CryptoAsset` ู ... ุฌุฏุง ุชุนุฑู ุดุฏูุฏุ ฺุฑุง ููุท ุงุฒ `AbstractAsset` ุงุณุชูุงุฏู ูุดุฏุ

### โ ูพุงุณุฎ ููุตู ู ุญุฑููโุง:

| ุงุตู                  | ุฏูู                                                                                                                                                                                      |
| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **OCP**              | ูุฑ ฺฉูุงุณ ุฏุฑ ุขูุฏู ุฑูุชุงุฑ ุฎุงุต ุฎูุงูุฏ ุฏุงุดุช. ูุซูุงู `CryptoAsset.get_transaction_fee()` ูโุชูุงูุฏ ุจู API ูุชุตู ุดูุฏุ ูู `StockAsset` ุจู ููุฏุงุฑ ุซุงุจุช. ุงู ูุงุจูุช ุจุฏูู ุชุบุฑ ฺฉูุงุณ ูุงูุฏ ุงูุฌุงู ูโุดูุฏ. |
| **LSP**              | ูุฑ ฺฉูุงุณ ูโุชูุงูุฏ ุฌุงฺฏุฒู ฺฉูุงุณ ูุงูุฏ ุดูุฏุ ุจุฏูู ุงูฺฉู ููุทู ุขู ุดฺฉุณุชู ุดูุฏ.                                                                                                                     |
| **ISP**              | ุงฺฏุฑ ETF ูุงุฒ ุจู ูุญุงุณุจู NAV ุฏุงุดุชู ุจุงุดุฏุ ุจู ุฑุงุญุช ุฏุฑ `ETFAsset` ุงุถุงูู ูโุดูุฏ ุจุฏูู ุงูฺฉู `StockAsset` ุขููุฏู ุดูุฏ.                                                                             |
| **DDD**              | ูุฑ ููุน ุฏุงุฑุง ฺฉ *ููููู ุฏุงููู* ูุชูุงูุช ุงุณุช (Bounded Context). ูพุณ ูุฏู ุฌุฏุงฺฏุงูู ูโุฎูุงูุฏ.                                                                                                     |
| **ูพุฑูุฒ ุงุฒ if-else** | ุจูโุฌุง ุจุฑุฑุณ ููุน ุฏุงุฑุง ุฏุฑ ูุฑ ุชุงุจุน ุจุง `if asset_class == ...`ุ ุฑูุชุงุฑ ุงุฒ ุทุฑู ฺฉูุงุณ ูุฌุฒุง ุชุนู ูโุดูุฏ.                                                                                      |

---

## ๐งพ ูุชุฏูุง ฺฉูุฏ

| ูุชุฏ                        | ุฏุฑ ฺฉุฏุงู ฺฉูุงุณ     | ุชูุถุญ                               |
| -------------------------- | ---------------- | ----------------------------------- |
| `is_valid()`               | `AbstractAsset`  | ุจุฑุฑุณ ุงุนุชุจุงุฑ ุฏุงุฑุง ุจุฑ ุงุณุงุณ ููุชโูุง |
| `get_price_limit()`        | `AbstractAsset`  | ุฏุงููู ููุณุงู ุงุฒ ูุงู ฺฉุงููฺฏ          |
| `get_transaction_fee()`    | `AbstractAsset`  | ุฏุฑุตุฏ ฺฉุงุฑูุฒุฏ ุงุฒ ฺฉุงููฺฏ               |
| `is_trading_now()`         | `AbstractAsset`  | ุจุฑุฑุณ ูุนุงู ุจูุฏู ุจุงุฒุงุฑ               |
| `has_price_limit_breach()` | `AbstractAsset`  | ุจุฑุฑุณ ุนุจูุฑ ุงุฒ ุฏุงููู ููุณุงู           |
| `get_spread()`             | `AbstractAsset`  | ุงุฎุชูุงู ask ู bid                    |
| `has_expired()`            | `AbstractOption` | ุงููุถุง ูุฑุงุฑุฏุงุฏ ุขูพุดู                 |
| `get_payoff()`             | `AbstractOption` | ูุญุงุณุจู ุณูุฏ ุง ุฒุงู ุขูพุดู             |

---

## ๐ Enumูุง

```python
class AssetClass(Enum):
    STOCK = "stock"
    ETF = "etf"
    LEVERAGE_ETF = "leverage_etf"
    CRYPTO = "crypto"
    ...

class Market(Enum):
    TSE_FIRST = ...
    IFB_SECOND = ...
    COMMODITY = ...
    ENERGY = ...
    BASE_YELLOW = ...
    ...

class OptionType(Enum):
    CALL = "call"
    PUT = "put"
```

---

## ๐งพ ููุงุจุน ุงุทูุงุนุงุช (config)

### ๐ `core/config/asset_rules.py`

```python
ASSET_TRANSACTION_FEES = {
    AssetClass.STOCK: 1.5,
    AssetClass.CRYPTO: 0.3,
    ...
}
```

### ๐ `core/config/trading_rules.py`

```python
ASSET_TRADING_HOURS = {
    AssetClass.STOCK: ("09:00", "12:30"),
    AssetClass.CRYPTO: ("00:00", "23:59"),
    ...
}

ASSET_SETTLEMENT_DAYS = {
    AssetClass.STOCK: 2,
    AssetClass.CRYPTO: 0,
    ...
}
```

### ๐ `core/config/market_rules.py`

```python
MARKET_PRICE_LIMITS = {
    Market.TSE_FIRST: 5.0,
    Market.BASE_YELLOW: 3.0,
    ...
}
```

---

## โ ูุชุฌูโฺฏุฑ

* ูุงู `entity` ููุจ ุฏุงููู ูพุฑูฺู ุงุณุช.
* ุชูุงู ุฑูุชุงุฑูุง ู ุณุงุฎุชุงุฑูุง ุจุง ุงุตูู ูุนูุงุฑ ุชูุฒ ุทุฑุงุญ ุดุฏูโุงูุฏ.
* ุงุฒ ูุฑฺฏููู hardcodeุ ูุงุจุณุชฺฏ ุจู ุชฺฉููููฺ ุง API ุงุฌุชูุงุจ ุดุฏู ุงุณุช.
* ุทุฑุงุญ ุจุฑุง ุชูุณุนู ุขูุฏู (ูุซูุงู ุงุถุงูู ุดุฏู ฺฉุงูุง ูุฒฺฉุ energy asset ู...) ุขูุงุฏู ุงุณุช.
