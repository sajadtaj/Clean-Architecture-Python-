<div dir='rtl'>

</div>

# ๐ฆ ุจุฎุด ุงูู: ูุนุฑู ู ุณุงุฎุชุงุฑ

---

## ๐งญ ูุฏู ูุงู Entity ุฏุฑ ูุนูุงุฑ ูพุงฺฉ (Clean Architecture)

ูุงู `Entity` ุฏุฑ ูุนูุงุฑ ูพุงฺฉ (Clean Architecture) ุจูโุนููุงู ููุจ ุฏุงูููโ ูพุฑูฺู ุดูุงุฎุชู ูโุดูุฏ. ุงู ูุงู ูุณุชูู ุงุฒ ูุฑููุฑฺฉโูุงุ ูพุงฺฏุงู ุฏุงุฏูุ APIุ UI ุง ูุฑ ูุงุจุณุชฺฏ ุฎุงุฑุฌ ุฏฺฏุฑ ุนูู ูโฺฉูุฏ ู ุดุงูู ูุฏูโูุง ุฏุงููู (Domain Models) ุงุณุช ฺฉู ุฑูุชุงุฑูุง ุงุตู ุณุณุชู ุฑุง ุชูุตู ูโฺฉููุฏ.

> ๐ฏ **ูุฏู ฺฉูุฏ ุงู ูุงู**:
> ูพุงุฏูโุณุงุฒ ููุณุฌู ููุงูู ุชุฌุงุฑ (Business Rules) ู ูุฏูโูุง ุงุตู ุณุณุชู ุจู ุดฺฉู ฺฉู ูุงุจู ุชุณุชุ ุชูุณุนูโูพุฐุฑ ู ูุณุชูู ุงุฒ ุชุบุฑุงุช ุชฺฉููููฺฺฉ ุจุงุดูุฏ.

---

## ๐งฑ ุงุฌุฒุง ุงุตู ูุงู Entity


</div>

```
core/
โโโ entities/
    โโโ asset/
    โ   โโโ asset.py
    โ   โโโ stock_asset.py
    โ   โโโ crypto_asset.py
    โ   โโโ etf_asset.py
    โ   โโโ leverage_etf_asset.py
    โโโ option/
    โ   โโโ option.py
    โ   โโโ stock_option.py
    โโโ enum/
    โ   โโโ enums.py
```
<div dir='rtl'>

### ๐น 1. `asset/`

ูุฏุฑุช ุงููุงุน ุฏุงุฑุง ูพุงู (ุณูุงูุ ุตูุฏููุ ฺฉุฑูพุชู) ุจุง ูฺฺฏโูุง ู ููุงุนุฏ ุฎุงุต ุจุงุฒุงุฑ

### ๐น 2. `option/`

ุชุนุฑู ุงูุชุฒุงุน ู ูพุงุฏูโุณุงุฒ ุขูพุดูโูุง (ุงุฎุชุงุฑ ูุนุงููู) ุดุงูู ูุชุฏูุง Payoffุ ูุถุนุช ูุฑุงุฑุฏุงุฏ ู ...

### ๐น 3. `enum/`

ุชุนุฑู ููุงุฏุฑ ุซุงุจุช ูุงููุฏ ุงููุงุน ุฏุงุฑุงุ ูุถุนุช ูุฑุงุฑุฏุงุฏ ู ููุน ุงุฎุชุงุฑ ูุนุงููู

---

## ๐งฉ ฺฉูุงุณโูุง ู ูุชุฏูุง ฺฉูุฏ ูุงู Entity

| ฺฉูุงุณ / ูุงฺูู       | ุชูุถุญ                  | ูุชุฏูุง ฺฉูุฏ                                                     |
| ------------------ | ---------------------- | ---------------------------------------------------------------- |
| `AbstractAsset`    | ฺฉูุงุณ ูพุงู ุฏุงุฑุงโูุง    | `get_price_limit()`, `get_transaction_fee()`, `is_trading_now()` |
| `StockAsset`       | ูพุงุฏูโุณุงุฒ ุณูุงู        | -                                                                |
| `CryptoAsset`      | ูพุงุฏูโุณุงุฒ ฺฉุฑูพุชู      | -                                                                |
| `ETFAsset`         | ูพุงุฏูโุณุงุฒ ุตูุฏูู ETF   | -                                                                |
| `LeverageETFAsset` | ูพุงุฏูโุณุงุฒ ุตูุฏูู ุงูุฑู | -                                                                |
| `AbstractOption`   | ฺฉูุงุณ ูพุงู ุขูพุดู         | `get_payoff()`, `get_break_even_price()`, `contract_status()`    |
| `StockOption`      | ูพุงุฏูโุณุงุฒ ุขูพุดู ุณูุงู   | -                                                                |
| `enums.py`         | ุงููุงุน ุซุงุจุช             | `AssetClass`, `Market`, `OptionType`, `ContractStatus`           |

---

## ๐งฐ ุจูโฺฉุงุฑฺฏุฑ ุงุตูู SOLID ุฏุฑ ุงู ูุงู

| ุงุตู       | ฺฉุงุฑุจุฑุฏ ุฏุฑ Entity Layer                                                                                                |
| --------- | --------------------------------------------------------------------------------------------------------------------- |
| โ **SRP** | ูุฑ ฺฉูุงุณ ุชููุง ูุณุฆูู ฺฉ ููุน ุฏุงุฑุง ุง ูุฏู ูุงู ุงุณุช. ูุงููุฏ `StockAsset` ุจุฑุง ุณูุงู ุง `AbstractOption` ุจุฑุง ูุฑุงุฑุฏุงุฏ ุขูพุดู. |
| โ **OCP** | ูุงุจูุช ุงูุฒูุฏู ุฏุงุฑุง ุง ุงุณุชุฑุงุชฺ ุฌุฏุฏ ุจุฏูู ุชุบุฑ ฺฉูุงุณโูุง ููุฌูุฏ ุงุฒ ุทุฑู ุงุฑุซโุจุฑ ู ุฏฺฉุชู ฺฉุฑุฏู ุงูุชุฑูุณโูุง              |
| โ **LSP** | ฺฉูุงุณโูุง ูุฑุฒูุฏ ูุงููุฏ `CryptoAsset` ุจุฏูู ุดฺฉุณุชู ุฑูุชุงุฑ ูุงูุฏ (`AbstractAsset`) ุฌุงฺฏุฒู ูโุดููุฏ                            |
| โ **ISP** | ุงุฒ @abstractmethod ุจุฑุง ุชุนู ุฑูุชุงุฑูุง ุฎุงุต ุจุฏูู ุชุญูู ุชูุงุจุน ุงุถุงู ุงุณุชูุงุฏู ุดุฏู                                         |
| โ **DIP** | ูุงุจุณุชฺฏโูุง ุจูโุตูุฑุช ูุงุจุณุชู ุจู ุงูุชุฑูุณ ุทุฑุงุญ ุดุฏูโุงูุฏุ ูู ุจู ฺฉูุงุณโูุง ูุดุฎุต                                              |

---

## ๐ ุงููุช Type Hinting ุฏุฑ ุงู ูุงู

* ุชูุงู ฺฉูุงุณโูุง ุฏุงุฑุง `Type Hint` ุจุฑุง ุณุงุฒฺฏุงุฑ ุจุง ุงุจุฒุงุฑูุง ุชุณุช ู CI/CD ูุณุชูุฏ.
* ุงุณุชูุงุฏู ุงุฒ `Optional`, `Tuple`, `Enum`, `@dataclass` ุฏุฑ ุณุทุญ ุจุงูุง.
* ฺฉูฺฉ ุจู ุชุญูู ุงุณุชุง (Static Analysis)ุ ุฎูุฏฺฉุงุฑุณุงุฒ ุชุณุชโูุง ู ุฌููฺฏุฑ ุงุฒ ุฎุทุงูุง ููุทู.


# ๐ ุจุฎุด ุฏูู: ูุนูุงุฑ ู ุฑูุงุจุท

---

## ๐งฑ ุณุงุฎุชุงุฑ ุงุฑุชุจุงุท ฺฉูุงุณโูุง ุฏุฑ ูุงู Entity

ุฏุฑ ุงู ูุงูุ ฺฉูุงุณโูุง ุจูโุดฺฉู **ุงูุชุฒุงุน (abstract)** ู **ุชุฎุตุตโุงูุชู (specialized)** ุทุฑุงุญ ุดุฏูโุงูุฏ ุชุง:

1. ุงุตูู **Open/Closed** ู **Liskov Substitution** ุฑุง ุฑุนุงุช ฺฉููุฏ.
2. ูุงูโ ููุทู ฺฉุณุจโูฺฉุงุฑ (Domain Logic) ุฑุง ุจูโุตูุฑุช ุฌุฏุงฺฏุงูู ุงุฒ ุณุงุฑ ูุงูโูุง ูฺฏูุฏุงุฑ ฺฉููุฏ.
3. ุจุฏูู ูุงุฒ ุจู ูพุงฺฏุงูโุฏุงุฏูุ UI ุง APIุ ูุงุจู ุชุณุช ู ุชูุณุนู ุจุงุดูุฏ.

### ๐ ุณุงุฎุชุงุฑ ูุงุจุณุชฺฏโูุง (Dependency Flow)

```mermaid
classDiagram
    class AbstractAsset {
        +name: str
        +symbol: str
        +market: Market
        +last_price: float
        +...
    }

    class StockAsset
    class ETFAsset
    class CryptoAsset
    class LeverageETFAsset

    class AbstractOption {
        +contract_name: str
        +strike_price: float
        +premium: float
        +underlying_asset: AbstractAsset
        +expiry: datetime
        +get_payoff(): float
        +get_break_even_price(): float
        ...
    }

    class StockOption

    AbstractAsset <|-- StockAsset
    AbstractAsset <|-- ETFAsset
    AbstractAsset <|-- CryptoAsset
    AbstractAsset <|-- LeverageETFAsset

    AbstractOption <|-- StockOption
    AbstractOption o-- AbstractAsset
```

---

## ๐งฉ ุงุฑุชุจุงุท ุจู ูุงฺููโูุง ุงุตู

| ูุงฺูู              | ูุงุจุณุชู ุจู                                   | ุชูุถุญ                                                                                             |
| ------------------ | ------------------------------------------- | ------------------------------------------------------------------------------------------------- |
| `asset.asset.py`   | `config.*`                                  | ุงุฒ ูุงูโูุง `trading_rules.py` ู `market_rules.py` ุจุฑุง ุชุนู ฺฉุงุฑูุฒุฏ ู ุฏุงููู ููุณุงู ุงุณุชูุงุฏู ูโฺฉูุฏ |
| `option.option.py` | `asset.asset.py`                            | ูุฑ ุขูพุดู ูุงุฒููุฏ ุฏุณุชุฑุณ ุจู ุฏุงุฑุง ูพุงู (`underlying_asset`) ุงุณุช                                    |
| `enum.enums.py`    | ูุณุชูู                                       | ุชูุณุท ุชูุงู ฺฉูุงุณโูุง Asset ู Option ุจุฑุง ุชุนู ููุนุ ูุถุนุชุ ุจุงุฒุงุฑ ุงุณุชูุงุฏู ูโุดูุฏ                    |
| `stock_option.py`  | `option.option.py` + `asset.stock_asset.py` | ููููู ูพุงุฏูโุณุงุฒ ุฏูู ุจุฑุง Option ูุจุชู ุจุฑ ุณูุงู                                                   |

---

## ๐ ูููุฏุงุฑ ูุงูโุง (Layered View)

</div>

```
core/entities/
โโโ asset/         <-- ุฏุงุฑุง ูพุงู (ุณูุงูุ ฺฉุฑูพุชูุ ETFุ ...)
โ   โโโ AbstractAsset  <-- ููุทู ูุฑูุฏ ฺฉู Option ูุง
โโโ option/        <-- ูุฑุงุฑุฏุงุฏ ุขูพุดู
โ   โโโ AbstractOption <-- ุชุนุฑู ุงูุชุฒุงุน ุงุฎุชุงุฑ ูุนุงููู
โโโ enum/          <-- ุงููุงุน ุซุงุจุช ู ููุงุฏุฑ Enums
```

<div dir='rtl'>

* ูุงู Option ูุงุจุณุชู ุจู Asset ุงุณุช โ
* Enums ุฏุฑ ูพุงูโุชุฑู ุณุทุญ ูุงุจุณุชฺฏ ูุณุชูุฏ โ
* ูฺ ูุงฺูู ุงุฒ ูุงูโูุง ุฎุงุฑุฌ ูุงููุฏ use\_cases ุง infrastructure ุฏุฑ ุงู ูุงู ุงุณุชูุงุฏู ูุดุฏู ุงุณุช โ



## ๐ ุฑุนุงุช Dependency Rule ุฏุฑ Clean Architecture

ุจุฑ ุงุณุงุณ **ูุงููู ูุงุจุณุชฺฏ (Dependency Rule)** ุฏุฑ Clean Architecture:

> "ูุงุจุณุชฺฏโูุง ููุดู ุจุงุฏ ุงุฒ ุจุฑูู ุจู ุฏุฑูู ุจุงุดูุฏุ ุนู ูุงูโูุง ุฏุงุฎู (Entities) ูุจุงุฏ ุจู ูุงูโูุง ุฎุงุฑุฌ (UseCases, Interfaces, Infra) ูุงุจุณุชู ุจุงุดูุฏ."

ูุงู `Entity` ฺฉุงููุงู ุงู ูุงููู ุฑุง ุฑุนุงุช ฺฉุฑุฏู ุงุณุช:

โ ุจุฏูู import ุงุฒ `use_cases`, `interfaces`, `infrastructure`
โ ููุท ุจู `enum` ู `config` (ููุฏุงุฑุฏู ู ููุงูู ุจุงุฒุงุฑ) ูุงุจุณุชู ุงุณุช
โ ุชูุงู ุชุนุงููุงุช ูุจุชู ุจุฑ abstraction ู interface ูุณุชูุฏ



# ๐ฆ ุจุฎุด ุณูู:  Asset


## ๐ฏ ูุฏู ูุงู Asset

ูุงูโ `Asset` ุฏุฑ ููุจ ูุงูโ `Entity` ูุฑุงุฑ ุฏุงุฑุฏ ู ูุฏู ุขู ูุฏูโุณุงุฒ ุฏุงุฑุงโูุง ูุงุจู ูุนุงูููโุง ูุงููุฏ ุณูุงูุ ุตูุฏููโูุง ุณุฑูุงูโฺฏุฐุงุฑุ ุงุฑุฒูุง ุฏุฌุชุงู ู ุตูุฏููโูุง ุงูุฑู ุงุณุช. ุงู ูุงู ุจุง ุฑุนุงุช ฺฉุงูู ุงุตูู ูุนูุงุฑ ูพุงฺฉ (Clean Architecture) ู ุงุตูู ุทุฑุงุญ SOLIDุ ุจูโฺฏูููโุง ุทุฑุงุญ ุดุฏู ฺฉู ูุงุจูุช ุชูุณุนูุ ุชุณุชโูพุฐุฑ ู ุชุทุจู ุจุง ููุงูู ุจุงุฒุงุฑูุง ูุงู ุฑุง ุฏุงุดุชู ุจุงุดุฏ.

---

## ๐งฉ ุงุฌุฒุง ุงุตู ูุงู Asset

- ูุณุฑ ูุงู:  
  `src/crypto_option_arbitrage/core/entities/Asset/`

- ูุงูโูุง ุงุตู:
  - `asset.py`: ฺฉูุงุณ ุงูุชุฒุงุน `AbstractAsset`
  - `stock_asset.py`: ุฏุงุฑุง ููุน ุณูุงู
  - `etf_asset.py`: ุฏุงุฑุง ููุน ุตูุฏูู ุณุฑูุงูโฺฏุฐุงุฑ
  - `leverage_etf_asset.py`: ุตูุฏูู ุงูุฑู
  - `crypto_asset.py`: ุงุฑุฒ ุฏุฌุชุงู

---

## ๐งฑ ฺฉูุงุณโูุง ู ูุชุฏูุง

#### โ ฺฉูุงุณ AbstractAsset

ฺฉูุงุณ ูพุงูโุง ุงูุชุฒุงุน ฺฉู ุชูุงู ุฏุงุฑุงโูุง ุงุฒ ุขู ุงุฑุซโุจุฑ ูโฺฉููุฏ ู ุดุงูู ูฺฺฏโูุง ู ูุชุฏูุง ูุดุชุฑฺฉ ุงุณุช.

- ูฺฺฏโูุง:
  - `name`, `symbol`, `isin`, `asset_class`, `market`
  - `last_price`, `close_price`, `previous_price`
  - `settlement_days`, `trading_hours`, `ask_price`, `bid_price`

- ูุชุฏูุง:
  - `get_price_limit()`: ุฏุฑุงูุช ุฏุงููู ููุณุงู ุจุงุฒุงุฑ
  - `get_transaction_fee()`: ุฏุฑุงูุช ฺฉุงุฑูุฒุฏ ุจุฑ ุงุณุงุณ ฺฉูุงุณ ุฏุงุฑุง
  - `is_trading_now()`: ุจุฑุฑุณ ุฒูุงู ูุฌุงุฒ ูุนุงููู
  - `has_price_limit_breach()`: ุจุฑุฑุณ ููุณุงู ููุช ุฎุงุฑุฌ ุงุฒ ุจุงุฒู ูุฌุงุฒ
  - `get_spread()`: ูุญุงุณุจู ุงุณูพุฑุฏ ุจู ููุช ุฎุฑุฏ ู ูุฑูุด
  - `is_valid()`: ุจุฑุฑุณ ุงุนุชุจุงุฑ ุฏุงุฏูโูุง ุฏุงุฑุง

#### โ ฺฉูุงุณโูุง ูุดุชูโุดุฏู

| ฺฉูุงุณ               | ูุฏู                                | ุชูุงูุชโูุง                                                                 |
|--------------------|-------------------------------------|--------------------------------------------------------------------------|
| `StockAsset`       | ูุฏูโุณุงุฒ ุณูุงู                      | ุงุฒ ุจุงุฒุงุฑ ุจูุฑุณ/ูุฑุงุจูุฑุณุ ุฏุงููู ููุณุงู ุซุงุจุชุ ุชุณูู ุฏู ุฑูุฒ ฺฉุงุฑ             |
| `ETFAsset`         | ุตูุฏููโูุง ุณุฑูุงูโฺฏุฐุงุฑ            | ูุดุงุจู ุณูุงู ุงูุง ฺฏุงู ุชุณูู ูุชูุงูุช ุง ุณุงุนุงุช ูุนุงููู ุจุดุชุฑ                  |
| `LeverageETFAsset` | ุตูุฏููโูุง ุงูุฑู                    | ุญุณุงุณ ุจู ููุณุงูุ ูุงุฒููุฏ ุชูุงุฒ ุฏูู ุฏุฑ ุชุณูู ู ููุณุงู                      |
| `CryptoAsset`      | ุงุฑุฒูุง ุฏุฌุชุงู                    | ุจุงุฒุงุฑ ุฌูุงูุ ุจุฏูู ุฏุงููู ููุณุงูุ ฒด ุณุงุนุชูุ ุชุณูู ูุญุธูโุง                 |

---

### โ๏ธ ุทุฑุงุญ ุงุตูู ุจุง SOLID

- **SRP**: ูุฑ ฺฉูุงุณ ููุท ฺฉ ูุณุฆููุช ุฏุงุฑุฏ (ูุซูุงู CryptoAsset ููุท ุงุฑุฒ ุฏุฌุชุงู)
- **OCP**: ุงูุฒูุฏู ุฏุงุฑุง ุฌุฏุฏ ุจุฏูู ุชุบุฑ ุฏุฑ ฺฉูุงุณโูุง ูุจู (ูุซูุงู ฺฉุงูุง ุง ุทูุง)
- **LSP**: ุชูุงู ฺฉูุงุณโูุง ูุฑุฒูุฏ ุจุฏูู ุงุฎุชูุงู ุฌุงฺฏุฒู `AbstractAsset` ูโุดููุฏ.
- **ISP**: ูฺฺฏโูุง ุฎุงุต ููุท ุฏุฑ ฺฉูุงุณโูุง ุงุนูุงู ุดุฏู ฺฉู ูุงุฒ ุฏุงุฑูุฏ.
- **DIP**: ุณุฑูุณโูุง ูุงุจุณุชู ุจู `AbstractAsset` ูุณุชูุฏ ูู ฺฉูุงุณ ุฎุงุต.

---

### ๐ก ุชุงูพโฺฏุฐุงุฑ ู ุชุณุชโูพุฐุฑ

- ุงุณุชูุงุฏู ุงุฒ `Type Hinting` ุจุฑุง ุชูุงู ูฺฺฏโูุง ู ุงูุถุงูุง ูุชุฏูุง
- ุทุฑุงุญ ูุณุชูู ุงุฒ ูุงูโูุง ูพุงู ุจุฑุง ุชุณุช ูุงุญุฏ
- ููุงุณุจ ุจุฑุง CI/CD ู ุชุณุช ุงุชููุงุชฺฉ ุจุง `pytest`



## โ ูุณุชูุฏ ุฏูู ุชูุงุจุน `AbstractAsset` 


### ๐ ุจุฑุฑุณ ู ูุณุชูุฏุณุงุฒ ุฏูู ูุชุฏูุง `AbstractAsset`

ุฏุฑ ุงู ุจุฎุด ุชูุงุจุน ุงุตู ฺฉูุงุณ `AbstractAsset` ุจูโุตูุฑุช ฺฉุงูู ุจุฑุฑุณ ู ุชุญูู ุดุฏูโุงูุฏ. ุงู ฺฉูุงุณุ ูุณุชู ุงุตู ุฏุงุฑุงโูุง ุฏุฑ ูุงู Entity ูุญุณูุจ ูโุดูุฏ ู ูพุงูโุง ุจุฑุง ุชูุงู ฺฉูุงุณโูุง ูุดุชูโุดุฏู ูุงููุฏ `StockAsset`ุ `ETFAsset` ู ุบุฑู ูโุจุงุดุฏ.


</div>

```python
def get_price_limit(self) -> float:
    return MARKET_PRICE_LIMITS.get(self.market, 0.0)
```

<div dir='rtl'>

๐น ุชุงุจุน `get_price_limit`:  
ูุฏู: ุฏุฑุงูุช ุฏุฑุตุฏ ูุฌุงุฒ ุฏุงููู ููุณุงู ููุช ุฏุงุฑุง ุจุง ุชูุฌู ุจู ุจุงุฒุงุฑ ุขู.

* ุงุจุชุฏุง ุงุฒ ุฏฺฉุดูุฑ `MARKET_PRICE_LIMITS` ุฏุฑ `market_rules.py` ุงุณุชูุงุฏู ูโฺฉูุฏ.
* ุงฺฏุฑ ุจุงุฒุงุฑ ุชุนุฑู ูุดุฏู ุจุงุดุฏุ ููุฏุงุฑ ูพุดโูุฑุถ ฐูช ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ.

</div>

```python
def get_transaction_fee(self) -> float:
    return ASSET_TRANSACTION_FEES.get(self.asset_class, 0.0)
```

<div dir='rtl'>

๐น ุชุงุจุน `get_transaction_fee`:  
ูุฏู: ุงุณุชุฎุฑุงุฌ ุฏุฑุตุฏ ฺฉุงุฑูุฒุฏ ูุนุงููู ุจุฑ ุงุณุงุณ ฺฉูุงุณ ุฏุงุฑุง.

* ุฏุงุฏูโูุง ุงุฒ ุฏฺฉุดูุฑ `ASSET_TRANSACTION_FEES` ุฏุฑ `asset_rules.py` ุฎูุงูุฏู ูโุดููุฏ.
* ุงฺฏุฑ ฺฉูุงุณ ุฏุงุฑุง ูพุดุชุจุงู ูุดูุฏุ ูพุดโูุฑุถ ุตูุฑ ุจุงุฒูโฺฏุฑุฏุฏ.

</div>

```python
def is_trading_now(self, current_time: Optional[datetime] = None) -> bool:
    now = current_time or datetime.now()
    start_str, end_str = self.trading_hours
    start = time.fromisoformat(start_str)
    end = time.fromisoformat(end_str)
    return start <= now.time() <= end
```

<div dir='rtl'>
๐น ุชุงุจุน `is_trading_now`:  
ูุฏู: ุจุฑุฑุณ ุงูฺฉู ุขุง ุฏุฑ ูุญุธู ูุนู ุฏุงุฑุง ูุงุจู ูุนุงููู ุงุณุช ุง ุฎุฑ.

* ุฒูุงู ุฌุงุฑ ุงุณุชุฎุฑุงุฌ ูโุดูุฏ (ุง ุงุฒ ูุฑูุฏ ุง ุงุฒ `datetime.now()`).
* ุจุง ุณุงุนุชโูุง ูุฌุงุฒ ูุนุงููุงุช (`trading_hours`) ููุงุณู ูโุดูุฏ.

</div>

```python
def has_price_limit_breach(self, current_price: float) -> bool:
    limit_percent = self.get_price_limit()
    upper_limit = self.close_price * (1 + limit_percent / 100)
    lower_limit = self.close_price * (1 - limit_percent / 100)
    return current_price > upper_limit or current_price < lower_limit
```

<div dir='rtl'>
๐น ุชุงุจุน `has_price_limit_breach`:  
ูุฏู: ุชุดุฎุต ุงูฺฉู ุขุง ููุช ูุนู ุงุฒ ุญุฏูุฏ ูุฌุงุฒ ููุณุงู ุนุจูุฑ ฺฉุฑุฏู ุง ูู.

* ุฏุฑุตุฏ ุฏุงููู ูุฌุงุฒ ุจุง `get_price_limit()` ฺฏุฑูุชู ูโุดูุฏ.
* ุญุฏูุฏ ุจุงูุง ู ูพุงู ูุญุงุณุจู ู ููุช ุฌุงุฑ ุจุง ุขููุง ููุงุณู ูโุดูุฏ.

</div>

```python
def get_spread(self) -> Optional[float]:
    if self.ask_price is not None and self.bid_price is not None:
        return self.ask_price - self.bid_price
    return None
```

<div dir='rtl'>
๐น ุชุงุจุน `get_spread`:  
ูุฏู: ูุญุงุณุจู ุชูุงูุช ุจู ููุช ูพุดููุงุฏ ูุฑูุด ู ุฎุฑุฏ.

* ุงฺฏุฑ ูุฑ ุฏู ููุฏุงุฑ `ask` ู `bid` ููุฌูุฏ ุจุงุดูุฏุ ุงุฎุชูุงู ุขูโูุง ุจูโุนููุงู ุงุณูพุฑุฏ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ.

</div>

```python
def is_valid(self) -> bool:
    return self.last_price > 0 and self.close_price > 0
```

<div dir='rtl'>
๐น ุชุงุจุน `is_valid`:  
ูุฏู: ุจุฑุฑุณ ุตุญุช ุงููู ุงุทูุงุนุงุช ุฏุงุฑุง.

* ููุท ุฒูุงู ูุนุชุจุฑ ุงุณุช ฺฉู ููุช ูพุงุงู ู ุขุฎุฑู ููุช ูุซุจุช ุจุงุดูุฏ.

---

# โ ุจุฎุด ฺูุงุฑู: Option



### ๐ฏ ูุฏู ูุงู Option

ูุงู Option ูุณุฆูู ูุฏูโุณุงุฒ ุฏูู ูุฑุงุฑุฏุงุฏูุง ุงุฎุชุงุฑ ูุนุงููู (Options) ุจุฑ ูุจูุง ุฏุงุฑุงโูุง ูพุงู (Assets) ุงุณุช. ุงู ูุงู ุจูโุตูุฑุช ุงูุชุฒุงุน ู ูุงุจู ุชูุณุนู ุทุฑุงุญ ุดุฏู ุชุง ุงูฺฉุงู ุชุนุฑู ุขูพุดู ุจุฑุง ุงููุงุน ุฏุงุฑุงโูุง (ุณูุงูุ ุตูุฏููโูุงุ ุฑูุฒุงุฑุฒ ู...) ูุฑุงูู ุดูุฏ.

ุทุฑุงุญ ุงู ูุงู ูุทุงุจู ุจุง ุงุตูู Clean Architecture ู SOLID ุงูุฌุงู ุดุฏู ู ุงุฒ ูุงุจุณุชฺฏ ุจู ุฒุฑุณุณุชูโูุง ุจุฑูู ุฌููฺฏุฑ ุดุฏู ุงุณุช.



## ๐ ุณุงุฎุชุงุฑ ูพูุดู ู ูุณุฑ ูุงู Option:

</div>

```
core/
โโโ entities/
    โโโ option/
        โโโ option.py              # ุชุนุฑู ฺฉูุงุณ ุงูุชุฒุงุน AbstractOption
        โโโ stock_option.py        # ูพุงุฏูโุณุงุฒ Option ุจุฑุง ุฏุงุฑุง Stock
        โโโ etf_option.py          # ูพุงุฏูโุณุงุฒ Option ุจุฑุง ุฏุงุฑุง ETF
        โโโ crypto_option.py       # ูพุงุฏูโุณุงุฒ Option ุจุฑุง ุฏุงุฑุง Crypto
        โโโ leverage_etf_option.py # ูพุงุฏูโุณุงุฒ Option ุจุฑุง ุฏุงุฑุง ุงูุฑู ETF
```

<div dir='rtl'>

## ๐งฑ ุงุฌุฒุง ุงู ูุงู

| ฺฉูุงุณ / ูุงู | ุชูุถุญ |
|-------------|--------|
| `AbstractOption` | ูพุงู ุทุฑุงุญ ุชูุงู ุขูพุดูโูุง. ุดุงูู ุฏุงุฏูโูุง ุนูููุ ูุชุฏูุง ุจุฑุฑุณ ูุถุนุชุ ุณูุฏุ ุณุฑุฑุณุฏ ู... |
| `StockOption` | ุขูพุดู ุจุฑุง ุณูุงู (StockAsset) |
| `ETFOption` | ุขูพุดู ุจุฑุง ุตูุฏููโูุง (ETFAsset) |
| `CryptoOption` | ุขูพุดู ุจุฑุง ุฑูุฒุงุฑุฒูุง (CryptoAsset) |
| `LeverageETFOption` | ุขูพุดู ุจุฑุง ุตูุฏููโูุง ุงูุฑู (LeverageETFAsset) |





## ๐ ฺฉูุงุณ ูพุงู `AbstractOption` (option.py)

</div>

```python
@dataclass
class AbstractOption(ABC):
    contract_name: str
    option_type: OptionType
    strike_price: float
    premium: float
    expiry: datetime
    underlying_asset: AbstractAsset
    ask: Optional[float] = None
    bid: Optional[float] = None
    contract_size: int = 1000
    transaction_fee: Optional[float] = None
    settlement_cost: Optional[float] = None
```

<div dir='rtl'>

โ ุฎุตูุตุงุช ฺฉูุฏ:
- ูุงุจุณุชู ุจู ฺฉูุงุณ ูพุงู `AbstractAsset` ุงุณุชุ ุงูุง ุจุฏูู ุขฺฏุงู ุงุฒ ููุน ุขู.
- ุชุงุจุน `get_payoff` ู `get_break_even_price` ุงูุชุฒุงุน ูุณุชูุฏ ู ุฏุฑ ฺฉูุงุณโูุง ูุฑุฒูุฏ ูพุงุฏูโุณุงุฒ ูโุดููุฏ.
- ูุชุฏูุง ูุถุนุช ูุฑุงุฑุฏุงุฏ ูุงููุฏ `is_in_the_money`, `has_expired`, `contract_status` ุจูโุตูุฑุช ุนููู ุชุนุฑู ุดุฏูโุงูุฏ ู ูุงุจู ุงุณุชูุงุฏู ุจุฑุง ูููโ ุงููุงุน ุขูพุดู ูุณุชูุฏ.
- ุงูุฏุงุฒู ูุฑุงุฑุฏุงุฏุ ูุฒูู ฺฉุงุฑูุฒุฏ ู ูุฒูู ุชุณูู ูุฒ ุจูโุตูุฑุช ูุณุชูู ูุฏุฑุช ูโุดููุฏ.

</div>

```mermaid
classDiagram
    AbstractAsset <|-- StockAsset
    AbstractAsset <|-- ETFAsset
    AbstractAsset <|-- CryptoAsset
    AbstractAsset <|-- LeverageETFAsset

    AbstractOption <|-- StockOption
    AbstractOption <|-- ETFOption
    AbstractOption <|-- CryptoOption
    AbstractOption <|-- LeverageETFOption

    AbstractOption --> AbstractAsset : underlying_asset
```


<div dir='rtl'>

โ ุงุฑุชุจุงุท ฺฉูุฏ:
- ูุฑ ุขูพุดู ูุงุจุณุชู ุจู ฺฉ ุฏุงุฑุง ูพุงู ุงุฒ ุฌูุณ `AbstractAsset` ุงุณุช.
- ุงูฺฉุงู ุงุฌุฑุง ุชุณุชุ ููุงุณูุ ุจุฑุฑุณ ูุถุนุช ู ุงุณุชุฑุงุชฺโูุง ุชุฑฺฉุจ ุฑุง ูุฑุงูู ูโุณุงุฒุฏ.
- ุงู ุทุฑุงุญ ุงุฒ ูุงููู LSP ูพุดุชุจุงู ูโฺฉูุฏ: ูุฑ `XOption` ูโุชูุงูุฏ ุจูโุฌุง `AbstractOption` ุงุณุชูุงุฏู ุดูุฏ.

</div>


---

### โ ุฑุนุงุช ุงุตูู SOLID

<div dir='rtl'>

| ุงุตู | ูพุงุฏูโุณุงุฒ |
|------|------------|
| SRP | ฺฉูุงุณโูุง ููุท ูุณุฆูู ฺฉ ููููู ูุณุชูุฏ: Asset ุง Option |
| OCP | ฺฉูุงุณโูุง Option ูุงุจู ุชูุณุนู ุจุฏูู ุชุบุฑ ฺฉูุงุณ ูพุงู ูุณุชูุฏ |
| LSP | ูุฑ ฺฉูุงุณ ูุฑุฒูุฏ Option ูโุชูุงูุฏ ุจูโุฌุง ฺฉูุงุณ ูพุงู ุงุณุชูุงุฏู ุดูุฏ |
| ISP | Interface ู API ุฏุงุฎู ฺฉูุงุณโูุง ููุท ุชูุงุจุน ููุฑุฏ ูุงุฒ ุฑุง ุชุนุฑู ูโฺฉููุฏ |
| DIP | ูุงุจุณุชฺฏ ุจู ุงูุชุฒุงุน (`AbstractAsset`) ุจูโุฌุง ฺฉูุงุณ ุฎุงุต ุญูุธ ุดุฏู ุงุณุช |






## ๐ ุชุญูู ฺฉุงูู ูุชุฏูุง ฺฉูุงุณ AbstractOption



ุฏุฑ ุงุฏุงููุ ูุฑ ฺฉ ุงุฒ ูุชุฏูุง ฺฉูุงุณ `AbstractOption` ุจูโุตูุฑุช ูุณุชูู ูุณุชูุฏ ุดุฏูโุงูุฏ. ุจุฑุง ูุฑ ูุชุฏุ ุชูุถุญ ูุฏูุ ููุน ุฎุฑูุฌุ ููุน ุฏุงุฏูโูุง ู ููููู ุงุณุชูุงุฏู ุขูุฑุฏู ุดุฏู ุงุณุช. ูุฏู ุงู ุงุณุช ฺฉู ูุณุชูุฏุณุงุฒ ุดูุงู ู ูุงุจู ุงุณุชูุงุฏู ุฏุฑ CI/CDุ ุชูุณุนู ุชู ู ุชุญูู ุงุณุชุฑุงุชฺโูุง ุงุฎุชุงุฑ ูุนุงููู ุจุงุดุฏ.



### โ 1. `time_to_expiry_days`

</div>

```python
@property
def time_to_expiry_days(self) -> int:
    return max((self.expiry - datetime.utcnow()).days, 0)
```

<div dir='rtl'>

- **ูุฏู:** ูุญุงุณุจู ุชุนุฏุงุฏ ุฑูุฒูุง ุจุงูโูุงูุฏู ุชุง ุชุงุฑุฎ ุณุฑุฑุณุฏ ูุฑุงุฑุฏุงุฏ ุงุฎุชุงุฑ.
- **ุฎุฑูุฌ:** ฺฉ ุนุฏุฏ ุตุญุญ ุบุฑ ููู (int)
- **ููุทู:** ุงุฎุชูุงู ุชุงุฑุฎ ูุนู ุจุง ุชุงุฑุฎ `expiry` ุฑุง ูุญุงุณุจู ูโฺฉูุฏ ู ุงฺฏุฑ ููู ุจูุฏ (ุนู ูุฑุงุฑุฏุงุฏ ูููุถ ุดุฏู)ุ ุตูุฑ ุจุฑูโฺฏุฑุฏุงูุฏ.
- **ูุทุงุจูุช ุจุง OCP:** ูุญุงุณุจู ุจูโุตูุฑุช ุนููู ุทุฑุงุญ ุดุฏู ู ูุงุฒ ุจู override ูุฏุงุฑุฏ.

**ูุซุงู:**

</div>

```python
option.time_to_expiry_days  # ูุฑุถุงู ุฎุฑูุฌ: 12
```

<div dir='rtl'>

---

### โ 2. `spot_price`

</div>

```python
@property
def spot_price(self) -> float:
    return self.underlying_asset.last_price
```


<div dir='rtl'>

- **ูุฏู:** ุฏุฑุงูุช ููุช ูุญุธูโุง ุฏุงุฑุง ูพุงู (Spot).
- **ูุงุจุณุชฺฏ:** ุจู `underlying_asset` ฺฉู ุงุฒ ููุน `AbstractAsset` ุงุณุช.
- **ุฎุฑูุฌ:** ุนุฏุฏ ุงุนุดุงุฑ (float) ููุงุงูฺฏุฑ ููุช ูุญุธูโุง.
- **ุงุตูู ุฑุนโุดุฏู:** DIP (ูุงุจุณุชู ุจู ุงูุชุฒุงุน)ุ LSP (ููู ุฏุงุฑุงโูุง ุงู ููุฏ ุฑุง ุฏุงุฑูุฏ).

**ูุซุงู:**

</div>

```python
option.spot_price  # ุฎุฑูุฌ ูุซู: 145.5
```

<div dir='rtl'>
---

### โ 3. `contract_status`

</div>

```python
@property
def contract_status(self) -> ContractStatus:
    if self.is_in_the_money():
        return ContractStatus.IN_THE_MONEY
    elif self.is_out_of_the_money():
        return ContractStatus.OUT_OF_THE_MONEY
    return ContractStatus.AT_THE_MONEY
```


<div dir='rtl'>

- **ูุฏู:** ุชุดุฎุต ูุถุนุช ุณูุฏ/ุฒุงู ูุฑุงุฑุฏุงุฏ ุงุฎุชุงุฑ ูุนุงููู.
- **ุฎุฑูุฌ:** ฺฉ ุงุฒ ุณู ููุฏุงุฑ `ContractStatus`:
  - `IN_THE_MONEY` (ุฏุฑ ุณูุฏ)
  - `AT_THE_MONEY` (ุฏุฑ ููุทู ุจโุชูุงูุช)
  - `OUT_OF_THE_MONEY` (ุฏุฑ ุถุฑุฑ)
- **ููุทู:** ุจุฑ ุงุณุงุณ ููุงุณู `spot_price` ู `strike_price`.

**ูุซุงู:**
</div>


```python
option.contract_status  # ุฎุฑูุฌ: ContractStatus.IN_THE_MONEY
```


---

### โ 4. `is_in_the_money`

```python
def is_in_the_money(self) -> bool:
    if self.option_type == OptionType.CALL:
        return self.spot_price > self.strike_price
    return self.spot_price < self.strike_price
```

`
<div dir='rtl'>

- **ูุฏู:** ุจุฑุฑุณ ุงูฺฉู ุขุง ูุฑุงุฑุฏุงุฏ ุงุฎุชุงุฑ ุฏุฑ ุณูุฏ ุงุณุช.
- **ููุทู:**
  - ุจุฑุง `CALL`: ููุช ุจุงุฒุงุฑ > ููุช ุงุนูุงู.
  - ุจุฑุง `PUT`: ููุช ุจุงุฒุงุฑ < ููุช ุงุนูุงู.
- **ุงุตูู:** SRP (ููุท ูุณุฆูู ููุทู ุณูุฏ ุจูุฏู)ุ OCP (ูุงุจู ุงุณุชูุงุฏู ุจุฑุง ููู ุงููุงุน ุขูพุดู)

**ูุซุงู:**

</div>

```python
option.is_in_the_money()  # ุฎุฑูุฌ: True
```


---

### โ 5. `is_out_of_the_money`

```python
def is_out_of_the_money(self) -> bool:
    if self.option_type == OptionType.CALL:
        return self.spot_price < self.strike_price
    return self.spot_price > self.strike_price
```

<div dir='rtl'>

- **ูุฏู:** ุจุฑุฑุณ ุงูฺฉู ุขุง ุงุฎุชุงุฑ ูุนุงููู ุฏุฑ ูุถุนุช ุถุฑุฑ ุงุณุช.
- **ุฎุฑูุฌ:** Boolean
- **ููุทู:** ุนฺฉุณ `is_in_the_money`

**ูุซุงู:**

```python
option.is_out_of_the_money()  # ุฎุฑูุฌ: False
```



---

### โ 6. `is_at_the_money`

</div>

```python
def is_at_the_money(self) -> bool:
    return self.spot_price == self.strike_price
```

<div dir='rtl'>

- **ูุฏู:** ุจุฑุฑุณ ุงูฺฉู ููุช ุจุงุฒุงุฑ ุฏููุงู ุจุง ููุช ุงุนูุงู ุจุฑุงุจุฑ ุงุณุช.
- **ฺฉุงุฑุจุฑุฏ:** ุชุญูู ููุทู ุจโุชูุงูุช ุฏุฑ ุงุณุชุฑุงุชฺโูุง.



---

### โ 7. `has_expired`

</div>

```python
def has_expired(self, now: Optional[datetime] = None) -> bool:
    return (now or datetime.utcnow()) >= self.expiry
```


<div dir='rtl'>

- **ูุฏู:** ุจุฑุฑุณ ุงููุถุง ูุฑุงุฑุฏุงุฏ
- **ูุฑูุฏ ุงุฎุชุงุฑ:** ุงฺฏุฑ `now` ูุฏููุ ุฒูุงู ูุนู ุณุณุชู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ.
- **ููุทู:** ููุงุณู ุจุง `expiry`

**ูุซุงู:**

```python
option.has_expired()  # ุฎุฑูุฌ: False
```



---

### โ 8. `is_valid`

</div>

```python
def is_valid(self) -> bool:
    return (
        self.strike_price > 0 and
        self.premium >= 0 and
        self.expiry > datetime.utcnow() and
        isinstance(self.underlying_asset, AbstractAsset)
    )
```


<div dir='rtl'>

- **ูุฏู:** ุจุฑุฑุณ ุงุนุชุจุงุฑ ุงููู ูุฑุงุฑุฏุงุฏ ุขูพุดู.
- **ุงุตูู ุฑุนโุดุฏู:** SRP (ููุท ูุณุฆูู ุจุฑุฑุณ ุงุนุชุจุงุฑ)

**ููุงุฑุฏ ุจุฑุฑุณโุดุฏู:**
- `strike_price` ูุซุจุช ุจุงุดุฏ.
- `premium` ููู ูุจุงุดุฏ.
- `expiry` ุฏุฑ ุขูุฏู ุจุงุดุฏ.
- `underlying_asset` ุงุฒ ฺฉูุงุณ ูุฌุงุฒ ุจุงุดุฏ.



### โ 9. `get_payoff`


</div>

```python
@abstractmethod
def get_payoff(self, spot_price: Optional[float] = None) -> float:
    ...
```


<div dir='rtl'>

### ูุฏู ุงู ูุชุฏ:
ูุญุงุณุจู **ุณูุฏ ุฎุงู** ุง ุฒุงู ูุฑุงุฑุฏุงุฏ ุงุฎุชุงุฑ ูุนุงููู ุฏุฑ ุชุงุฑุฎ ุณุฑุฑุณุฏ ุง ููุช ููุฑุฏ ูุธุฑ.

### ููุน ุฎุฑูุฌ:
`float` โ ูุจูุบ ุณูุฏ (ููฺฉู ุงุณุช ููู ุจุงุดุฏ ุฏุฑ ุตูุฑุช ุฒุงู)

### ูุฑูุฏ:
- `spot_price`: ููุช ูุญุธูโุง ุจุงุฒุงุฑ ุจุฑุง ุฏุงุฑุง ูพุงู.
  - ุงฺฏุฑ ููุฏุงุฑ ูุฏููุ ุงุฒ `self.spot_price` ฺฉู ุจู `underlying_asset.last_price` ุงุดุงุฑู ุฏุงุฑุฏ ุงุณุชูุงุฏู ูโุดูุฏ.

### ุทุฑุงุญ ุงูุชุฒุงุน:
ุงู ูุชุฏ ุงูุชุฒุงุน (abstract) ุงุณุช ู ุฏุฑ ฺฉูุงุณโูุง ูุฑุฒูุฏ ูุงููุฏ `StockOption`, `CryptoOption` ูพุงุฏูโุณุงุฒ ูโุดูุฏุ ฺูู:
- ูุฑููู ุณูุฏ ูุงุจุณุชู ุจู ููุน ุฏุงุฑุง ุง ุจุงุฒุงุฑ ุงุณุช.
- ุญุฌู ูุฑุงุฑุฏุงุฏุ ฺฉุงุฑูุฒุฏุ ุดุฑุงุท ุจุงุฒุงุฑ ูโุชูุงูุฏ ูุชูุงูุช ุจุงุดุฏ.


## ๐ฏ ุชุนุฑู Payoff ุฏุฑ ูุนุงููุงุช ุงุฎุชุงุฑ

**Payoff** ุจู ูุนู "ููุฏุงุฑ ุณูุฏ ุง ุฒุงู ุฎุงู" ุฏุฑ ุณุฑุฑุณุฏ ฺฉ ูุฑุงุฑุฏุงุฏ ุงุฎุชุงุฑ ุงุณุช.

---

## ๐ ูุฑููู ุฑุงุถ ุงุณุชุงูุฏุงุฑุฏ

### โ Payoff ุจุฑุง **Call Option** (ุงุฎุชุงุฑ ุฎุฑุฏ):

</div>

```math
Payoff_{Call} = max(0, S_T - K)
```

* $S_T$: ููุช ุฏุงุฑุง ูพุงู ุฏุฑ ุณุฑุฑุณุฏ (spot price)
* $K$: ููุช ุงุนูุงู (strike price)

---
<div dir='rtl'>

### โ Payoff ุจุฑุง **Put Option** (ุงุฎุชุงุฑ ูุฑูุด):

</div>

```math
Payoff_{Put} = max(0, K - S_T)
```
<div dir='rtl'>
---

## ๐ ูุฑููู ุณูุฏ ููุง (Net Profit)

### ุงฺฏุฑ ุจุฎูุงูู ุณูุฏ ูุงูุน ูพุณ ุงุฒ ูุฒููโูุง ุฑุง ูุญุงุณุจู ฺฉูู:

</div>

```math
NetProfit = (Payoff - Premium - SettlementCost) ร ContractSize - Fee
```

* **Premium**: ูุจูุบ ฺฉู ุจุฑุง ุฎุฑุฏ ุงุฎุชุงุฑ ูพุฑุฏุงุฎุช ุดุฏู.
* **SettlementCost**: ูุฒูู ุชุณูู (ฺฉุงุฑูุฒุฏ ูุงุธุฑุ ูุงูุงุชุ ...)
* **ContractSize**: ุญุฌู ูุฑุงุฑุฏุงุฏ (ูุซูุงู 1000 ูุงุญุฏ)
* **Fee**: ุฏุฑุตุฏ ฺฉุงุฑูุฒุฏ ูุนุงููุงุช \* ุญุงุตู ุนุจุงุฑุช ุจุงูุง

---

<div dir='rtl'>

## ๐ก ูุฑููู ฺฉุงูู ููุง ุจุฑุง `get_payoff`

</div>

```math
NetPayoff = \left[ \max(0, S_T - K) - Premium - SettlementCost \right] ร ContractSize - Fee
```

<div dir='rtl'>

---

### ๐ ูุซุงู ฑ: ูพุงุฏูโุณุงุฒ ุจุฑุง `StockOption`

</div>

```python
def get_payoff(self, spot_price: Optional[float] = None) -> float:
    spot = spot_price if spot_price is not None else self.spot_price
    raw_payoff = self.calculate_raw_payoff(spot)
    total = (raw_payoff - self.premium - self.settlement_cost) * self.contract_size
    fee_amount = total * (self.transaction_fee / 100)
    return total - fee_amount
```

<div dir='rtl'>

#### ุฎุท ุจู ุฎุท:

1. ุชุนู ููุช ูุญุธูโุง:

```python
spot = spot_price if spot_price is not None else self.spot_price
```

ุงฺฏุฑ ูุฑูุฏ ุฏุงุฏู ุงุฒ ุขู ุงุณุชูุงุฏู ูโฺฉููุ ูฺฏุฑูู ุงุฒ `underlying_asset.last_price`.


2. ูุญุงุณุจู ุณูุฏ ุฎุงู:


```python
raw_payoff = self.calculate_raw_payoff(spot)
```

ุจุฑุง `CALL`: `max(spot - strike, 0)`
ุจุฑุง `PUT`: `max(strike - spot, 0)`

---

3. ุงุนูุงู ูุฒููโูุง:

```python
total = (raw_payoff - self.premium - self.settlement_cost) * self.contract_size
```

* `premium`: ูุจูุบ ูพุฑุฏุงุฎุช ุจุฑุง ุฎุฑุฏ ุงุฎุชุงุฑ.
* `settlement_cost`: ูุฒูู ุชุณูู (ูุซูุงู ูุงูุงุชุ ฺฉุงุฑูุฒุฏ ูุฑุงุจูุฑุณ).
* `contract_size`: ุญุฌู ูพุดโูุฑุถ ูุฑุงุฑุฏุงุฏ (ูุซูุงู ฑฐฐฐ ูุงุญุฏ).

---

4. ฺฉุณุฑ ฺฉุงุฑูุฒุฏ:

</div>

```python
fee_amount = total * (self.transaction_fee / 100)
return total - fee_amount
```
<div dir='rtl'>

---

### ูุซุงู ููุง:

ูุฑุถ ฺฉูู:

* CALL ุจุง strike=160
* ููุช ุจุงุฒุงุฑ (spot) = 170
* premium = 5
* settlement\_cost = 1
* contract\_size = 1000
* transaction\_fee = 0.5%

ูุญุงุณุจู:

* `raw_payoff = 10`
* `total = (10 - 5 - 1) * 1000 = 4000`
* `fee = 0.005 * 4000 = 20`
* `payoff = 3980`



---

### โ 10. `get_break_even_price`

</div>

```python
@abstractmethod
def get_break_even_price(self) -> float:
    ...
```


<div dir='rtl'>

### ูุฏู ุงู ูุชุฏ:
ูุญุงุณุจู ููุช ฺฉู ุฏุฑ ุขู ูุนุงูููโฺฏุฑ ูู ุณูุฏ ุฏุงุฑุฏ ู ูู ุฒุงู.

### ููุน ุฎุฑูุฌ:
`float` โ ููุช ุณุฑ ุจู ุณุฑ

### ุทุฑุงุญ ุงูุชุฒุงุน:
ฺูู Break-even ุจุฑุง CALL ู PUT ุชูุงูุช ุฏุงุฑุฏุ ู ุญุช ููฺฉู ุงุณุช ุฏุฑ ุจุฑุฎ ุจุงุฒุงุฑูุง ูุงููุฏ ฺฉุฑูพุชู ูุฒูู ุชุณูู ูุฏุงุดุชู ุจุงุดูุ ุงู ูุชุฏ ุจุงุฏ ุฏุฑ ฺฉูุงุณโูุง ูุฑุฒูุฏ ูพุงุฏูโุณุงุฒ ุดูุฏ.

---

### ูุฑูููโูุง ุฑุงุฌ:


- **CALL Option**:  
```python
strike_price + premium + settlement_cost + (fee optional)
```

* **PUT Option**:

```python
strike_price - premium - settlement_cost
```

> ุฏุฑ ุนููุ ฺฉุงุฑูุฒุฏ ููฺฉู ุงุณุช ุจู break-even ุงุถุงูู ุดูุฏ.

---

### ูุซุงู:

ุจุฑุง CALL:

* strike: 160
* premium: 5
* settlement: 1.5

```python
break_even = 160 + 5 + 1.5 = 166.5
```

ุจุฑุง PUT:

* strike: 160
* premium: 4
* settlement: 1

```python
break_even = 160 - 4 - 1 = 155.0
```

# ๐งฉ ุจุฎุด ูพูุฌู: Enum

๐ ูุณุฑ: `core/entities/enum/enums.py`

---

## ๐ฏ ูุฏู ุงุฒ ูุงู Enum

ูุงู Enum ูุธูู ุชุนุฑู **ููุงุฏุฑ ุซุงุจุช ุทุจููโุจูุฏโุดุฏู** ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ ฺฉู ุฏุฑ ุณุฑุงุณุฑ ูพุฑูฺู ุจูโุตูุฑุช ฺฉูพุงุฑฺู ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑูุฏ. ุงู ููุงุฏุฑ:

* ุจุงุนุซ ุฎูุงูุง ุจุดุชุฑ ฺฉุฏ ูโุดููุฏ.
* ุงุญุชูุงู ุจุฑูุฒ ุฎุทุงูุง ููุทู (ูุงููุฏ ุชุงูพ ุงุดุชุจุงู ุฑุดุชูโูุง) ุฑุง ฺฉุงูุด ูโุฏููุฏ.
* ุงูฺฉุงู refactor ุจุฏูู ุดฺฉุณุช ุฑุง ูุฑุงูู ูโฺฉููุฏ.
* ูุงุจุณุชฺฏ ูุณุชูู ุจู domain ุฏุงุฑูุฏ.

---

### ๐งฑ ุงุตูู ุฑุนุงุชโุดุฏู

* **SRP**: ูุฑ enum ุชููุง ุจุฑุง ฺฉ ูุฏู ุทุฑุงุญ ุดุฏู ุงุณุช.
* **LSP**: ุชูุงู ููุงุฏุฑ enum ูุงุจู ุงุณุชูุงุฏู ุฌุงฺฏุฒู ฺฉุฏฺฏุฑ ูุณุชูุฏ.
* **OCP**: ุงูุฒูุฏู ููุงุฏุฑ ุฌุฏุฏ ุจุฏูู ุชุบุฑ ุฏุฑ ุณุงุฎุชุงุฑ ููุฌูุฏ ููฺฉู ุงุณุช.
* **Type Hinting** ุฏูู ุจุง `Enum` ู `StrEnum` ุจูโุตูุฑุช ููโุชุงูพ ุงูุฌุงู ุดุฏู ุงุณุช.

---

## ๐งฉ ฺฉูุงุณโูุง ู ุงุนุถุง Enum

#### 1. `AssetClass`

ุงููุงุน ฺฉูุงุณโูุง ุฏุงุฑุง ูพุงู:

</div>

```python
class AssetClass(str, Enum):
    STOCK = "Stock"
    ETF = "ETF"
    LEVERAGED_ETF = "Leveraged ETF"
    CRYPTO = "Crypto"
    COMMODITY = "Commodity"
```
<div dir='rtl'>


โ ุงู ฺฉูุงุณ ุฏุฑ ุชูุงู ฺฉูุงุณโูุง ุฏุงุฑุง ูพุงู ูุซู `StockAsset`, `CryptoAsset` ุงุณุชูุงุฏู ูโุดูุฏ.

---

#### 2. `Market`

ุจุงุฒุงุฑูุง ฺฉู ุฏุงุฑุงโูุง ุฏุฑ ุขู ูุนุงููู ูโุดููุฏ:

</div>

```python
class Market(str, Enum):
    TSE_FIRST = "TSE First Market"
    TSE_SECOND = "TSE Second Market"
    IFB_FIRST = "IFB First Market"
    IFB_SECOND = "IFB Second Market"
    IFB_BASE_YELLOW = "IFB Base Yellow"
    IFB_BASE_ORANGE = "IFB Base Orange"
    IFB_BASE_RED = "IFB Base Red"
    IRENEX = "Energy Exchange"
    IME = "Mercantile Exchange"
    GLOBAL = "Global"
```
<div dir='rtl'>

โ `Market` ุจุฑุง ุชุนู ุฏุงููู ููุณุงูุ ุจุงุฒู ุฒูุงู ูุนุงููุงุช ู ฺฉูุชุฑูโูุง ูุฎุชูู ุฏุฑ ฺฉูุงุณโูุง asset ุงุณุชูุงุฏู ูโุดูุฏ.

---

#### 3. `OptionType`

ููุน ุงุฎุชุงุฑ ูุนุงููู:


</div>

```python
class OptionType(str, Enum):
    CALL = "Call"
    PUT = "Put"
```
<div dir='rtl'>

โ ุฏุฑ ฺฉูุงุณ `AbstractOption` ู ฺฉูุงุณโูุง ูุฑุฒูุฏ ุจุฑุง ูุญุงุณุจู ูุถุนุช ูุฑุงุฑุฏุงุฏ ู ูุญุงุณุจุงุช Payoff ุงุณุชูุงุฏู ูโุดูุฏ.

---

#### 4. `ContractStatus`

ูุถุนุช ูุฑุงุฑุฏุงุฏ:

</div>

```python
class ContractStatus(str, Enum):
    IN_THE_MONEY = "ITM"
    OUT_OF_THE_MONEY = "OTM"
    AT_THE_MONEY = "ATM"
```

<div dir='rtl'>

โ ุฏุฑ ูุชุฏ `contract_status` ุงุฒ ฺฉูุงุณ Option ุจุฑุง ูุดุฎุต ฺฉุฑุฏู ูุถุนุช ูุญุธูโุง ูุฑุงุฑุฏุงุฏ ุงุณุชูุงุฏู ูโุดูุฏ.

---

## ๐ ุงุฑุชุจุงุท ุจุง ุณุงุฑ ูุงูโูุง

| Enum             | ุงุณุชูุงุฏู ุฏุฑ ฺฉูุงุณโูุง                 | ูุฏู                   |
| ---------------- | ---------------------------------- | --------------------- |
| `AssetClass`     | ุชูุงู ฺฉูุงุณโูุง ุฏุงุฑุง ูพุงู          | ุชุนู ฺฉูุงุณ ุฏุงุฑุง     |
| `Market`         | ุฏุฑ `AbstractAsset`, `market_rules` | ุชุนู ููุฑุฑุงุช ุจุงุฒุงุฑ    |
| `OptionType`     | ุฏุฑ `AbstractOption`, ุชุณุชโูุง        | ุชุดุฎุต ููุน ุงุฎุชุงุฑ      |
| `ContractStatus` | ุฏุฑ ูุชุฏ `contract_status`           | ุชุญูู ูุถุนุช ูุนุงูููโฺฏุฑ |

---

### โ ูฺฉุงุช ููู

* ุชูุงู enumูุง ุงุฒ `str, Enum` ุงุฑุซโุจุฑ ฺฉุฑุฏูโุงูุฏ ุชุง ุฏุฑ JSON ู API ุจู ุฑุงุญุช ูุงุจู ุณุฑุงูโุณุงุฒ ุจุงุดูุฏ.
* Enumูุง ุจู ุฌุง hardcoded string ุงุณุชูุงุฏู ุดุฏูโุงูุฏ ุชุง ุชูุณุนู ุขุณุงู ู ุณุฑุนโุชุฑ ุดูุฏ.


# ๐งฐ ุจุฎุด ุดุดู: Config 

๐ ูุณุฑ: `core/config/`
ุดุงูู ูุงูโูุง:

* `asset_rules.py`
* `market_rules.py`
* `trading_rules.py`

---

## ๐ฏ ูุฏู ฺฉู ูุงู ฺฉุงููฺฏโูุง

ูุงู `config` ุฏุฑ ูุนูุงุฑ Clean ุจุฑุง ุชุนุฑู ู ูฺฏูุฏุงุฑ **ููุงููุ ูุญุฏูุฏุชโูุง ู ููุงุฏุฑ ูุงุจู ุชุบุฑ** ุงุณุชูุงุฏู ูโุดูุฏุ ุจู ุนุจุงุฑุช:

โ ูุธูู ุงุตู ุงู ูุงูุ **ุฌุฏุงุณุงุฒ ุฏุงุฏูโูุง ูุงุจู ูพฺฉุฑุจูุฏ ุงุฒ ููุทู ุงุตู ุณุณุชู** ุงุณุช.

---

### ๐งฑ ุงุตูู ุทุฑุงุญ ุฑุนุงุชโุดุฏู

| ุงุตู     | ุชูุถุญ                                                                              |
| ------- | ---------------------------------------------------------------------------------- |
| **SRP** | ุชุบุฑ ููุงุฏุฑ ููุงูู ูุจุงุฏ ฺฉูุงุณโูุง ูุณุชู ุฑุง ุชุญุช ุชุฃุซุฑ ูุฑุงุฑ ุฏูุฏ.                     |
| **OCP** | ููุงูู ูุงุจู ุงูุฒูุฏู ู ฺฏุณุชุฑุด ุจุฏูู ุชุบุฑ ุฏุฑ ฺฉูุงุณโูุง ููุฌูุฏ.                           |
| **LSP** | ฺฉูุงุณโูุง ุงุณุชูุงุฏูโฺฉููุฏู ุงุฒ ุงู ููุงุฏุฑ ูุจุงุฏ ุฏุฑ ุตูุฑุช ุชุบุฑ ุฏฺุงุฑ ุฑูุชุงุฑ ูุงููุฎูุงู ุดููุฏ. |
| **DIP** | ููุงูู ุงุฒ ุฎุงุฑุฌ ุจู ฺฉูุงุณโูุง Entity ุชุฒุฑู ูโุดููุฏุ ูุงุจุณุชฺฏ ูุนฺฉูุณ ุจุฑูุฑุงุฑ ุงุณุช.         |

---

## ๐ฆ ุณุงุฎุชุงุฑ ูุงูโูุง ู ฺฉุงุฑุจุฑุฏ ุขูโูุง

#### 1. `asset_rules.py`

๐ ูฺฏูุฏุงุฑ ฺฉุงุฑูุฒุฏ ูุนุงููู ุฏุงุฑุงโูุง (ุจุฑุงุณุงุณ ฺฉูุงุณ ุฏุงุฑุง)

</div>

```python
ASSET_TRANSACTION_FEES: dict[AssetClass, float] = {
    AssetClass.STOCK: 0.5,
    AssetClass.ETF: 0.25,
    AssetClass.LEVERAGED_ETF: 0.3,
    AssetClass.CRYPTO: 0.0,
}
```

<div dir='rtl'>

โ ุงุณุชูุงุฏูโุดุฏู ุฏุฑ:
ฺฉูุงุณโูุง ุฏุงุฑุง ูพุงู (ูุซู `AbstractAsset`) ุจุฑุง ูุญุงุณุจู `get_transaction_fee()`.

---

#### 2. `market_rules.py`

๐ ูฺฏูุฏุงุฑ ุฏุงููู ููุณุงู ูุฌุงุฒ ูุฑ ุจุงุฒุงุฑ

</div>

```python
MARKET_PRICE_LIMITS: dict[Market, float] = {
    Market.TSE_FIRST: 5.0,
    Market.IFB_BASE_YELLOW: 3.0,
    Market.GLOBAL: 0.0,
}
```
<div dir='rtl'>

โ ุงุณุชูุงุฏูโุดุฏู ุฏุฑ:
`get_price_limit()` ุฏุฑ `AbstractAsset` ุจุฑุง ุจุฑุฑุณ ุดฺฉุณุช ูุญุฏูุฏู ูุฌุงุฒ.

---

#### 3. `trading_rules.py`

๐ ูฺฏูุฏุงุฑ ุฒูุงู ูุนุงููุงุช ู ูุฏุช ุชุณูู ุจุฑุง ูุฑ ฺฉูุงุณ ุฏุงุฑุง

</div>

```python
ASSET_SETTLEMENT_DAYS: dict[AssetClass, int] = {
    AssetClass.STOCK: 2,
    AssetClass.ETF: 1,
    AssetClass.CRYPTO: 0,
}
ASSET_TRADING_HOURS: dict[AssetClass, tuple[str, str]] = {
    AssetClass.STOCK: ("09:00", "12:30"),
    AssetClass.CRYPTO: ("00:00", "23:59"),
}
```

<div dir='rtl'>

โ ุงุณุชูุงุฏูโุดุฏู ุฏุฑ:
ุฏุฑ ุณุงุฒูุฏู ฺฉูุงุณโูุง ูุฑุฒูุฏ ุฏุงุฑุง ูุงููุฏ `StockAsset`, `CryptoAsset`.

---

## โ ฺุฑุง ูู ุงุฒ `Enum` ุงุณุชูุงุฏู ุดุฏู ู ูู ุงุฒ `Config`ุ

| ุชูุงูุช                      | Enum                                          | Config                                                          |
| -------------------------- | --------------------------------------------- | --------------------------------------------------------------- |
| ๐ **ูุงููุช**              | ุฏุงุฏูโูุง ุทุจููโุจูุฏโุดุฏู ู ุซุงุจุช (ุบุฑูุงุจู ุชุบุฑ) | ููุงูู ูุงุจู ูพฺฉุฑุจูุฏ ู ุชุบุฑ                                    |
| ๐ **ูุฑุฎ ุชุบุฑ**           | ุชูุฑุจุงู ุตูุฑ (ุฏุฑ ุทูู ุฒูุงู ูุงุฏุฑ ุชุบุฑ ูโฺฉููุฏ)  | ุจุณุชู ุจู ูุงููู ู ุจุงุฒุงุฑุ ููฺฉู ุงุณุช ูุงูุงูู ุง ุญุช ุฑูุฒุงูู ุชุบุฑ ฺฉููุฏ |
| ๐ฏ **ูุซุงูโูุง**             | `AssetClass`, `Market`, `OptionType`          | `ุฏุงููู ููุณุงู`, `ฺฉุงุฑูุฒุฏ`, `ุฒูุงู ุชุณูู`                           |
| โ **ฺฉุงุฑุจุฑุฏ ุฏุฑ ุชูุณุนู**      | ุดุฑุทโูุงุ ุชุทุจู Enum ุฏุฑ ฺฉูุงุณโูุง ู ุงูฺฏูุฑุชูโูุง   | ูุญุงุณุจูโูุง ุฏููุ ููุงูู ูุฑูุงูโุณุงุฒ ู ุงุนุชุจุงุฑุณูุฌ                 |
| ๐งฉ **ูพุงุฏูโุณุงุฒ ูพุดููุงุฏ** | ุจุง `Enum` ุงุณุชุงูุฏุงุฑุฏ ูพุงุชูู                    | ุจุง ุฏฺฉุดูุฑโูุง ุง YAML/JSON ุง ูพุงฺฏุงูโุฏุงุฏู ุฏุฑ ุขูุฏู ูุงุจู ุงุฑุชูุง   |

---

### ๐ง ุชุญูู ููุง

* ุงุฒ `Enum` ุจุฑุง ููุงุฏุฑ **ุชุบุฑโูุงูพุฐุฑ**ุ ูุงุจู ุงุณุชูุงุฏู ุฏุฑ ููุทู ุดุฑุทุ ููุงุณูโุง ู ุชุงูพโูุง ุงูู ุงุณุชูุงุฏู ุดุฏู ุงุณุช.
* ุงุฒ `config` ุจุฑุง ููุงุฏุฑ **ูพูุงุ ูุงูููโูุญูุฑ ู ุชุบุฑูพุฐุฑ** ุงุณุชูุงุฏู ุดุฏู ฺฉู ุจุงุฏ ุจูโุฑุงุญุช ูุงุจู ุชุบุฑ ุจุงุดูุฏ (ุจุฏูู ุชุบุฑ ฺฉูุงุณโูุง).
* ุฏุฑ ุขูุฏู ูโุชูุงู ุงู configูุง ุฑุง ุงุฒ ูุงู JSONุ ุง ุฏุชุงุจุณุ ุง ุญุช API ุฏุฑุงูุช ฺฉุฑุฏ ู ุณุณุชู ููฺูุงู ูุณุชูู ุจุงู ุจูุงูุฏ.

---

## ๐ ุงุชุตุงู ูุงู ฺฉุงููฺฏ ุจุง Entity

```mermaid
graph TD;
    AssetClass -->|ฺฉูุฏ| ASSET_TRANSACTION_FEES;
    Market -->|ฺฉูุฏ| MARKET_PRICE_LIMITS;
    AssetClass -->|ฺฉูุฏ| ASSET_TRADING_HOURS;
    AbstractAsset -->|ุงุณุชูุงุฏู| Configs;
    AbstractAsset -->|ุชูุณุนู| StockAsset & CryptoAsset;
```

---

### โ ูุชุฌูโฺฏุฑ

ุณุงุฎุชุงุฑ Config + Enum ุชุฑฺฉุจ ุงุฒ **ุงุณุชูุงุฑ ููุทู** ู **ุงูุนุทุงู ุนููุงุช** ุงุณุช ฺฉู ูู ุจุง ุงุตูู Clean Architecture ู SOLID ุณุงุฒฺฏุงุฑ ุงุณุช ู ูู ุจุฑุง CI/CD ู ุชูุณุนูโูพุฐุฑ ุขูุงุฏู ุงุณุช.

---



